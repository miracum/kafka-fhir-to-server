name: "Verify base image signature"
on: [pull_request]

permissions: read-all

jobs:
  validate:
    name: verify
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@8ade135a41bc03ea155e62e844d188df1ea18608 # v4.1.0
      - name: Install Cosign
        uses: sigstore/cosign-installer@6e04d228eb30da1757ee4e1dd75a0ec73a653e06 # v3.1.1
      - run: |
          cosign dockerfile verify \
                --output text \
                --base-image-only \
                --certificate-oidc-issuer https://accounts.google.com \
                --certificate-identity keyless@distroless.iam.gserviceaccount.com \
                Dockerfile
