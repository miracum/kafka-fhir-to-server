version: "3.9"

services:
  kafka-fhir-to-server:
    image: ${KAFKA_FHIR_TO_SERVER_IMAGE:-ghcr.io/miracum/kafka-fhir-to-server:latest}
    environment:
      FHIR_URL: http://fhir:8080/fhir
      BOOTSTRAP_SERVERS: "kafka1:19092"
    depends_on:
      - fhir
      - kafka1

  test:
    build: .
    environment:
      FHIR_SERVER_URL: "http://fhir:8080/fhir"
    depends_on:
      - fhir
      - kafka-fhir-to-server
      - mock-data-loader
